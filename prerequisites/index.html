
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Pre-Requisites - Db2 Click to Containerize</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pre-requisites" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Db2 Click to Containerize" class="md-header__button md-logo" aria-label="Db2 Click to Containerize" data-md-component="logo">
      
  <img src="../img/IBM_logo®_rev_RGB.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Db2 Click to Containerize
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Pre-Requisites
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Db2 Click to Containerize" class="md-nav__button md-logo" aria-label="Db2 Click to Containerize" data-md-component="logo">
      
  <img src="../img/IBM_logo®_rev_RGB.png" alt="logo">

    </a>
    Db2 Click to Containerize
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Pre-Requisites
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Pre-Requisites
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#target-users" class="md-nav__link">
    Target Users
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#db2-shift-program-requirements" class="md-nav__link">
    Db2 Shift Program Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#temporary-space-requirements" class="md-nav__link">
    Temporary Space Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#language-requirements" class="md-nav__link">
    Language Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectivity-requirements" class="md-nav__link">
    Connectivity Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networking-requirements" class="md-nav__link">
    Networking Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userid-and-authentication-requirements" class="md-nav__link">
    Userid and Authentication Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#target-database-requirements" class="md-nav__link">
    Target Database Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-database-requirements" class="md-nav__link">
    Source Database Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hadr-settings" class="md-nav__link">
    HADR Settings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instance-owner-and-dbadm-and-secadm-userid" class="md-nav__link">
    Instance Owner and DBADM and SECADM Userid
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../bestpractices/" class="md-nav__link">
        Shift Considerations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../gui/" class="md-nav__link">
        User Interface Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Authentication
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Authentication" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Authentication
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ssh/" class="md-nav__link">
        SSH Authentication
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cluster/" class="md-nav__link">
        Cluster Authentication
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Command Line
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Command Line" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Command Line
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../syntax/" class="md-nav__link">
        Db2 Shift Syntax
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        Options Reference
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Shift Scenarios
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Shift Scenarios" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Shift Scenarios
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scenarios/" class="md-nav__link">
        Scenario Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../shiftpod/" class="md-nav__link">
        Db2 Shift to Pod
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../shiftinstance/" class="md-nav__link">
        Db2 Shift to Instance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../clone/" class="md-nav__link">
        Clone a Database
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deploypod/" class="md-nav__link">
        Deploy a Clone to a Pod
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../deployinstance/" class="md-nav__link">
        Deploy a Clone to an Instance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadrpod/" class="md-nav__link">
        HADR Setup Instance to Pod
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hadrinstance/" class="md-nav__link">
        HADR Setup Instance to Instance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ldapdmc/" class="md-nav__link">
        LDAP and DMC Initialization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../clonecopy/" class="md-nav__link">
        Clone Copying
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        Options Reference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../support/" class="md-nav__link">
        Support
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../disclaimer/" class="md-nav__link">
        Disclaimer
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#target-users" class="md-nav__link">
    Target Users
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#db2-shift-program-requirements" class="md-nav__link">
    Db2 Shift Program Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#temporary-space-requirements" class="md-nav__link">
    Temporary Space Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#language-requirements" class="md-nav__link">
    Language Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#connectivity-requirements" class="md-nav__link">
    Connectivity Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#networking-requirements" class="md-nav__link">
    Networking Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#userid-and-authentication-requirements" class="md-nav__link">
    Userid and Authentication Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#target-database-requirements" class="md-nav__link">
    Target Database Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#source-database-requirements" class="md-nav__link">
    Source Database Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hadr-settings" class="md-nav__link">
    HADR Settings
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#instance-owner-and-dbadm-and-secadm-userid" class="md-nav__link">
    Instance Owner and DBADM and SECADM Userid
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="pre-requisites">Pre-requisites</h1>
<p>The are several pre-requisites for running the Db2 Shift
program itself, as well as requirements related to the Db2
database and the target Db2 system. The Db2 Shift program
will analyze the source database and prevent any shifts from
occurring that will not work because of the target database
environment. </p>
<p>An additional analysis feature is provided
which will determine if any INSTANCE parameters on the
source system need to be moved to the TARGET system. The
database can be shifted without the corresponding target
INSTANCE settings being modified, but it may affect the
behavior of the database when it is running in the new
environment.</p>
<h2 id="target-users">Target Users</h2>
<p>The Db2 Shift program has been designed for experienced DBAs
or casual users through the GUI interface. It is more likely
that the user interface will be used for analysis and
initial testing while production use will use the command
line version. </p>
<p>The user requires intimate knowledge of
current INSTANCE settings to make sure the containerized
environment has sufficient resources to run the workloads.
Further details of what is required to run the Db2 Shift
program is described below.</p>
<h2 id="db2-shift-program-requirements">Db2 Shift Program Requirements</h2>
<p>The Db2 Shift program is a single executable Linux program
that can be installed in any directory. The only requirement
is that the program is marked as executable and is
accessible to the Db2 INSTANCE owner.</p>
<p>The program itself is self-contained and does not require
any additional libraries to run. The program can be removed
by simply deleting the file. When the program executes, it
will generate temporary files that are used during the shift
process. It is recommended that the program be run from
within a directory so that all files generated can be easily
found.</p>
<p>The program itself requires only 8M of space and sufficient
disk space for the log and control files that are generated.</p>
<p>The following Linux environments have been tested as source
systems:</p>
<ul>
<li>Linux X64, CentOS (6,7,8), CentOS Stream, Red Hat (6,7,8) Ubuntu (18.04, 20.04, 22.04), SUSE (12,15), openSUSE 15</li>
<li>Linux PPC (PowerPC) Little Endian has been tested as a source and target location</li>
</ul>
<h2 id="temporary-space-requirements">Temporary Space Requirements</h2>
<p>The Db2 Shift program requires access to the temporary file directory (<code>/tmp</code>) to
unpack the executable and for temporary storage of control files.</p>
<p>The Db2 Shift program generates temporary files in the process of analyzing the source and 
destination databases. The source instance must have access to the <code>/tmp</code> directory. If you
are shifting to a traditional Db2 instance (not a Db2u container on OpenShift or Kubernetes), the
target server must also provide access to the <code>/tmp</code> directory.</p>
<p>If you execute the Db2 Shift command and an error similar to the following appears:</p>
<pre><code>db2shift: error while loading shared libraries: libz.so.1: 
failed to map segment from shared object
</code></pre>
<p>This indicates that the executable is unable to unpack the libraries required to run the 
code. You can start the Db2 Shift program by creating an alternate temp space location:</p>
<pre><code>mkdir ~/TMP
export TMPDIR=~/TMP
</code></pre>
<p>If you are able to start the Db2 Shift program at this point you will know that the 
executable is correct. However, this will not provide the proper permissions for the
Db2 Shift process to execute.</p>
<p>The following command will display the permission bits of the <code>/tmp</code> directory:</p>
<pre><code>ls -ad /tmp
</code></pre>
<p>Your display will be similar to the following:</p>
<pre><code>drwxrwxrwt. 17 root root 4096 Dec  5 16:28 /tmp
</code></pre>
<p>If <code>rwx</code> is not available to all users then you will not be able to run the program. The
permission bits should be changed to:</p>
<pre><code>sudo chmod 1777 /tmp
</code></pre>
<p>If the permission bits appear to be correct, then the problem may be with the way the
<code>/tmp</code> directory has been mounted. Using the <code>df</code> command, you will be able to
determine if <code>/tmp</code> has a mount point.</p>
<pre><code>df
...
/dev/nvme0n2     5232640    69544   5163096   2% /tmp
...
</code></pre>
<p>If <code>/tmp</code> is mounted to a separate file system, you need to reissue the mount 
command to allow execution in the <code>/tmp</code> directory.</p>
<pre><code>sudo mount /tmp -o remount,exec
</code></pre>
<p>This should allow the program to run without file system errors. Make sure that both 
the source and target are set to allow execution in the <code>/tmp</code> directory. Note that 
the requirement for <code>/tmp</code> at the target only applies to databases being shifted
to another instance, <strong>not</strong> Db2U containers found in OpenShift, Kubenetes or 
Cloud Pak for Data. </p>
<p>One you have completed the shift, you can restore the <code>/tmp</code> settings back to 
restricting execution of commands.</p>
<pre><code>sudo mount /tmp -o remount,noexec
</code></pre>
<h2 id="language-requirements">Language Requirements</h2>
<p>The Db2 Shift utility requires that the Db2 commands be executed with the
environment setting set to <code>en_US</code> (or equivalent English):</p>
<pre><code>setenv LANG=en_US.utf8
</code></pre>
<p>If you do not change the language setting, the command results cannot be interpreted due 
to the translation that is done by the command interpreter.</p>
<h2 id="connectivity-requirements">Connectivity Requirements</h2>
<p>The shifting of a database from one environment to another
requires connectivity between the servers. The process by
which Db2 Shift moves data requires a connection to either
an OpenShift/Kubernetes/CP4D cluster, a server-less ssh
connection, or a local connection.</p>
<p>When shifting data to OpenShift, Kubernetes, or CP4D, the
Db2 Shift program will require the following:</p>
<ul>
<li>
<p>A suitable client for the Cluster software</p>
<ul>
<li>OpenShift CLI (oc) 4.0+ for OpenShift and Cloud Pak for Data shifts</li>
<li>Kuberbetes CLI (kubectl) for all Kubernetes clusters</li>
<li>SSH serverless connection to the target system</li>
<li>Local connection does not require a client but is only available for deployment of cloned databases</li>
</ul>
</li>
<li>
<p>OpenShift Version 3.11, 4.x </p>
</li>
<li>Cloud Pak for Data 3.5, 4.x</li>
<li>Kubernetes Version 1.19</li>
<li>A connection between the Source and Target servers </li>
<li>Sufficient disk space in /tmp or other directory (for Clone operations only)</li>
</ul>
<p><strong>Note 1:</strong> Only the OpenShift 4.0+ client is supported for shift operations. The
target cluster can be OpenShift 3.11 or OpenShift 4.0+.</p>
<p><strong>Note 2:</strong> Some Linux distributions do not support the
OpenShift CLI. Customers wanting to
shift from an environment that does not support the 
OpenShift CLI will need to use the Clone option and then copy the clone
directory to a client that does support the OC client.</p>
<p>For an OpenShift or Cloud Pak for Data
environment, download a copy of the <code>OC</code> version 4 command line interface from:</p>
<ul>
<li><a href="https://access.redhat.com/">Red Hat Customer Portal</a></li>
<li><a href="https://github.com/openshift/oc">OpenShift Github</a></li>
<li><a href="https://docs.okd.io/latest/cli_reference/openshift_cli/getting-started-cli.html">OpenShift Community Distribution</a></li>
</ul>
<p>For Kubernetes distributions, you can download the code from:</p>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/tools/">Kubernetes Tools</a> </li>
</ul>
<p>You can also issue the following command from a Linux terminal window to download
the code:</p>
<pre><code>curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&quot;
</code></pre>
<p>Once the code has been downloaded, place the code into the
local bin directory and make sure that it has been marked as
executable.</p>
<pre><code>chmod +x kubectl
mkdir -p ~/.local/bin
mv ./kubectl ~/.local/bin/kubectl
</code></pre>
<h2 id="networking-requirements">Networking Requirements</h2>
<p>A direct shift between two servers (or a POD) requires that you have a network connection
between the two sites. If you clone a database then you need to be able to copy the clone
directory to the destination (or intermediate) site.</p>
<p>Networking performance is discussed in the section on <a href="../bestpractices/#threads-and-compression">threads and compression</a>.</p>
<p>If your network is highly congested, there is a possibility that the rsync process used to move files will encounter a
network timeout. This problem will manifest itself with an error similar to the following:</p>
<pre><code>rsync error: unexplained error (code 255) at io.c(235) [sender=3.1.3]
Error: Exitcode = 255
</code></pre>
<p>The error will be repeated by the number of threads you specified in the shift syntax (<code>--threads=x</code>). </p>
<p>One of the reasons for a rsync connection being unexpectedly closed is the timeout issue, especially when it takes a 
while to calculate file checksums to check the differences on the remote host. To avoid this problem, you need to add
these settings into your <code>~/.ssh/config</code> (local) or <code>/etc/ssh/ssh_config</code> (global) files:</p>
<pre><code>Host *
  ServerAliveInterval 30
  ServerAliveCountMax 6
</code></pre>
<p>If you still encounter timeout issues, you may also want to update the settings on the remote server (in /etc/ssh/sshd_config), e.g.</p>
<pre><code>ClientAliveInterval 30
ClientAliveCountMax 6
</code></pre>
<p>See the following articles for more details</p>
<ul>
<li><a href="https://serverfault.com/questions/447699/rsync-error-unexplained-error-code-255-at-io-c/818482#818482" target="_blank">RSYNC Error code 255</a></li>
<li><a href="https://superuser.com/questions/1355421/rsync-stopped-working-and-returns-rsync-error-unexplained-error-code-255-at" target="_blank">RSYNC Unexplained error</a></li>
</ul>
<h2 id="userid-and-authentication-requirements">Userid and Authentication Requirements</h2>
<p>The Db2 Shift operation must take place under the userid of
the INSTANCE owner of the database being shifted.
Traditionally this userid has been db2inst1 but may be
different in your environment. The user must be logged in as
the INSTANCE owner and must have access to the db2shift
command.</p>
<p>The instance owner must also have ssh server-less
connectivity to the TARGET system if a Db2-to-Db2 instance
shift is being performed. The ssh connection is not required
when shifting into a containerized (OpenShift, Kubernetes,
CP4D) environment.</p>
<p>To access the TARGET pod in a cluster, the user must have
authenticated to OpenShift or Kubernetes and have access to
the POD that Db2 is running on. For OpenShift environments,
authentication is done either through a userid and password
or a token. An example of connecting with a userid/password:</p>
<p><code>oc login -u ocadmin -p ocadmin</code></p>
<p>Shifting to Cloud Pak for Data does not require a CP4D userid. The OpenShift userid or token for the 
underlying cluster is required to authenticate for the Db2 Shift operation.</p>
<p>Kubernetes installations will require the use of a profile (Config) to connect to the cluster. </p>
<p>For both OpenShift and Kubernetes shift operations, the namespace (Kubernetes) or project (OpenShift) name
will be required. In the case of CP4D the namespace is usually <code>cp4d</code> but it depends on how the cluster
was deployed. In OpenShift and Kubernetes, the default namespace/project must be set <strong>prior</strong> to 
running the Db2 Shift command. You can override the namespace and project in the command but setting
the namespace prior to executing the script will minimize errors with Db2u pods not being found.</p>
<h2 id="target-database-requirements">Target Database Requirements</h2>
<p>The target database should be created before running the Db2
Shift command. The Db2 Shift command cannot create the
database for you in containerized environments (OpenShift,
Kubernetes, CP4D). You must use the CP4D console to create a
new database, or the Db2u Operators on OpenShift or
Kubernetes to create and deploy the Db2 database. For
traditional Db2 installations, the database would be created
using the CREATE DATABASE command.</p>
<p>The new database name should be the same as the database
being shifted. This is a strict requirement for CP4D
databases, but not necessary for the other environments. Db2
Shift will take the existing database and clone it into the
target database name.</p>
<p>For shifting or cloning a database to a traditional Db2
Instance, Db2 Shift will create the database on your behalf
if you specify the create database flag. Otherwise, the
program will stop execution because the target database will
not be found.</p>
<p>Db2 databases created in clustered environments are always
created at the latest level (11.5.7+). For traditional Db2
instances created using the db2install command, a minimum
level of 11.5 should be used since prior versions are now
considered out of service.</p>
<p>In addition, the nodes of an MPP configuration must match
that of the SOURCE database and the memory, disk, and cores
should match the SOURCE database requirements. </p>
<h2 id="source-database-requirements">Source Database Requirements</h2>
<p>The source database can be moved as long as the following conditions are met:</p>
<ul>
<li>The database resides on a Linux server (X64 or PowerLinux LE)</li>
<li>The database was created with Automatic storage</li>
<li>The database is an OLTP, SMP, or MPP system</li>
<li>Row or Column mode storage, including encrypted databases</li>
<li>Mirror, Archive, and Overflow Logs</li>
<li>User Defined Functions/Procedures located in the SQL lib Directory</li>
<li>Db2 Version 10.5, 11.1, or 11.5 servers can be moved and upgraded at the same time</li>
</ul>
<p>The following features are not currently supported:</p>
<ul>
<li>pureScale Feature (Not available yet in the Db2u container) </li>
<li>Text Extender </li>
</ul>
<p>There are a few configuration settings which cannot be shifted:</p>
<ul>
<li>Only databases created with automatic storage are supported</li>
<li>The system contains external procedures which are not in the standard Db2 library - these will need to be manually recreated and catalogued</li>
<li>The LOGARCHMETH1/2 setting only supports DISK as a target in Db2u</li>
<li>The database encryption keys will be moved to the new location, but if the target already has encrypted databases then you will need to manually migrate the encryption key to the target location</li>
<li>The 11.5.7 <code>ctrl_recov_file_path</code> database setting must be set to <code>NULL</code> before shifting a database. If the setting is anything other than <code>NULL</code>, the target database will not be able to start until an identical path is available at the target. </li>
</ul>
<h2 id="hadr-settings">HADR Settings</h2>
<p>A database being shifted must not be in HADR <code>PRIMARY</code> or
<code>STANDBY</code> mode. You must stop HADR before attempting to do a
shift, otherwise the system will issue an error message.</p>
<pre><code>Error: HADR STATUS FOR SOURCE NOT VALID, Value Supplied: PRIMARY
Error: Failed HADR_status Check.
Make sure neither the source nor the target are not in HADR mode
</code></pre>
<p>The Db2 Shift utility creates an exact copy of the database, including 
all database settings. The HADR setting is tied to the database and 
creating a copy will conflict with the original database. You could
potentially have two primaries attempting to communicate to the same 
standby server.</p>
<h2 id="instance-owner-and-dbadm-and-secadm-userid">Instance Owner and DBADM and SECADM Userid</h2>
<p>Special care must be taken when moving a database into Cloud Pak for Data or into any Db2U deployment. The Db2U POD always uses db2inst1 as the instance owner. If your instance owner is different (i.e., db2inst2), the db2inst1 user at the target will not have any privileges on this database. You will not be able to manage the database.</p>
<p>In addition, for Cloud Pak for Data environments, your database name on CP4D must match the source database name. If the database names are mismatched, the Data Management Console and CP4D services will be unable to detect and manage the database.</p>
<p>If you are shifting a database to Cloud Pak for Data or a Db2u POD, and your source INSTANCE userid is not db2inst1, you must execute the following SQL commands from a userid that has SECADM authority:</p>
<pre><code>GRANT SECADM ON DATABASE TO USER db2inst1
GRANT DBADM  ON DATABASE TO USER db2inst1 
</code></pre>
<p>The <code>db2inst1</code> userid does not need to exist in the
Operating system to grant these privileges to the userid. If
you are moving the database to a traditional Db2 instance,
you could always create a new userid at the OS level to
manage the database, but this option is not available in a
container.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
          </div>
        </a>
      
      
        
        <a href="../installation/" class="md-footer__link md-footer__link--next" aria-label="Next: Installation" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Installation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022, 2023 IBM
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>